devices:
  arch: [grayskull, wormhole_b0, blackhole]

queues:
  input0: {type: queue, input: HOST, entries: 4, grid_size: [7, 8], t: 1, mblock: [3, 3], ublock: [1, 2], df: Float16, target_device: 0, loc: dram, dram: [[0, 0x10000000], [0, 0x10026440], [0, 0x1004c880],
      [0, 0x10072cc0], [0, 0x10099100], [0, 0x100bf540], [0, 0x100e5980], [0, 0x1010bdc0], [0, 0x10132200], [0, 0x10158640], [0, 0x1017ea80], [0, 0x101a4ec0], [0, 0x101cb300], [0, 0x101f1740], [0, 0x10217b80],
      [0, 0x1023dfc0], [0, 0x10264400], [0, 0x1028a840], [0, 0x102b0c80], [0, 0x102d70c0], [0, 0x102fd500], [0, 0x10323940], [0, 0x10349d80], [0, 0x103701c0], [0, 0x10396600], [0, 0x103bca40], [0, 0x103e2e80],
      [0, 0x104092c0], [0, 0x1042f700], [0, 0x10455b40], [0, 0x1047bf80], [0, 0x104a23c0], [0, 0x104c8800], [0, 0x104eec40], [0, 0x10515080], [0, 0x1053b4c0], [0, 0x10561900], [0, 0x10587d40], [0, 0x105ae180],
      [0, 0x105d45c0], [0, 0x105faa00], [0, 0x10620e40], [0, 0x10647280], [0, 0x1066d6c0], [0, 0x10693b00], [0, 0x106b9f40], [0, 0x106e0380], [0, 0x107067c0], [0, 0x1072cc00], [0, 0x10753040], [0, 0x10779480],
      [0, 0x1079f8c0], [0, 0x107c5d00], [0, 0x107ec140], [0, 0x10812580], [0, 0x108389c0]]}
  input1: {type: queue, input: HOST, entries: 4, grid_size: [8, 8], t: 1, mblock: [3, 3], ublock: [2, 4], df: Float16, target_device: 0, loc: dram, dram: [[0, 0x1085ee00], [0, 0x108f7e40], [0, 0x10990e80],
      [0, 0x10a29ec0], [0, 0x10ac2f00], [0, 0x10b5bf40], [0, 0x10bf4f80], [0, 0x10c8dfc0], [0, 0x10d27000], [0, 0x10dc0040], [0, 0x10e59080], [0, 0x10ef20c0], [0, 0x10f8b100], [0, 0x11024140], [0, 0x110bd180],
      [0, 0x111561c0], [0, 0x111ef200], [0, 0x11288240], [0, 0x11321280], [0, 0x113ba2c0], [0, 0x11453300], [0, 0x114ec340], [0, 0x11585380], [0, 0x1161e3c0], [0, 0x116b7400], [0, 0x11750440], [0, 0x117e9480],
      [0, 0x118824c0], [0, 0x1191b500], [0, 0x119b4540], [0, 0x11a4d580], [0, 0x11ae65c0], [0, 0x11b7f600], [0, 0x11c18640], [0, 0x11cb1680], [0, 0x11d4a6c0], [0, 0x11de3700], [0, 0x11e7c740], [0, 0x11f15780],
      [0, 0x11fae7c0], [0, 0x12047800], [0, 0x120e0840], [0, 0x12179880], [0, 0x122128c0], [0, 0x122ab900], [0, 0x12344940], [0, 0x123dd980], [0, 0x124769c0], [0, 0x1250fa00], [0, 0x125a8a40], [0, 0x12641a80],
      [0, 0x126daac0], [0, 0x12773b00], [0, 0x1280cb40], [0, 0x128a5b80], [0, 0x1293ebc0], [0, 0x129d7c00], [0, 0x12a70c40], [0, 0x12b09c80], [0, 0x12ba2cc0], [0, 0x12c3bd00], [0, 0x12cd4d40], [0, 0x12d6dd80],
      [0, 0x12e06dc0]]}
  output: {type: queue, input: op0, entries: 4, grid_size: [7, 8], t: 1, mblock: [3, 3], ublock: [1, 4], df: Float16, target_device: 0, loc: host, host: [[0, 0x12e9fe00], [0, 0x12eec640], [0, 0x12f38e80],
      [0, 0x12f856c0], [0, 0x12fd1f00], [0, 0x1301e740], [0, 0x1306af80], [0, 0x130b77c0], [0, 0x13104000], [0, 0x13150840], [0, 0x1319d080], [0, 0x131e98c0], [0, 0x13236100], [0, 0x13282940], [0, 0x132cf180],
      [0, 0x1331b9c0], [0, 0x13368200], [0, 0x133b4a40], [0, 0x13401280], [0, 0x1344dac0], [0, 0x1349a300], [0, 0x134e6b40], [0, 0x13533380], [0, 0x1357fbc0], [0, 0x135cc400], [0, 0x13618c40], [0, 0x13665480],
      [0, 0x136b1cc0], [0, 0x136fe500], [0, 0x1374ad40], [0, 0x13797580], [0, 0x137e3dc0], [0, 0x13830600], [0, 0x1387ce40], [0, 0x138c9680], [0, 0x13915ec0], [0, 0x13962700], [0, 0x139aef40], [0, 0x139fb780],
      [0, 0x13a47fc0], [0, 0x13a94800], [0, 0x13ae1040], [0, 0x13b2d880], [0, 0x13b7a0c0], [0, 0x13bc6900], [0, 0x13c13140], [0, 0x13c5f980], [0, 0x13cac1c0], [0, 0x13cf8a00], [0, 0x13d45240], [0, 0x13d91a80],
      [0, 0x13dde2c0], [0, 0x13e2ab00], [0, 0x13e77340], [0, 0x13ec3b80], [0, 0x13f103c0]]}

graphs:
  test_op:
    target_device: 0
    input_count: 2
    op0:
      type: matmul
      grid_loc: [0, 0]   # [r,c]
      grid_size: [7, 8] # [r,c]
      inputs: [input0, input1]
      in_df: [Float16, Float16]
      acc_df: Float16
      out_df: Float16
      intermed_df: Float16
      ublock_order: r
      buf_size_mb: 2
      math_fidelity: HiFi3
      attributes: {m_k: 24, u_kt: 2}
      untilize_output: false
      t: 1
      mblock: [3, 3]
      ublock: [1, 4]
      input_0_tms:
      input_1_tms: None

programs:
- program0:
  - var: [$c_loop_count, $c_input_count]
  - staticvar: {$lptr: 0, $gptr: 0}
  - varinst: [$c_loop_count, set, 1]      # load loop count
  - varinst: [$c_input_count, set, 2]
  - loop: $c_loop_count
  - execute: {graph_name: test_op, queue_settings: {input0: {prologue: false, epilogue: false, zero: false, rd_ptr_local: $lptr, rd_ptr_global: $gptr}, input1: {prologue: false, epilogue: false, zero: false,
          rd_ptr_local: $lptr, rd_ptr_global: $gptr}}}
  - varinst: [$lptr, incwrap, $c_input_count, 8]     # add two variables
  - varinst: [$gptr, incwrap, $c_input_count, 8]     # add two variables
  - endloop

test-config:
  test-args:
    program_loop_count: 1
  comparison-config:
    type: AllCloseHw
    atol: 0.01
    rtol: 0.15
    check_pct: 0.8
    check_pcc: 0.99
    verbosity: Concise
  stimulus-config:
    type: Uniform
    uniform_lower_bound: -2.0
    uniform_upper_bound: 2.0
